# 配置文件位置

Spring Boot 应用的配置文件主要放在以下目录：

- **classpath**： `src/main/resources/application.properties`

# 配置优先级

Spring Boot 配置的优先级从高到低如下：

1. **命令行参数**：通过 `java -jar app.jar --server.port=8080` 方式传递
2. **环境变量**：系统环境变量，如 `SPRING_DATASOURCE_URL`
3. **Java 系统属性**：通过 `-D` 参数传递，如 `java -Dserver.port=8080 -jar app.jar`
4. **配置文件**：
   - `application-{profile}.properties/yml`：特定环境的配置文件
   - `application.properties/yml`：默认配置文件

# 常用配置格式

Spring Boot 支持两种主要的配置文件格式：

::: code-group

```properties [properties]
# application.properties

# 服务器配置
server.port=8080
server.servlet.context-path=/api

# 数据源配置
spring.datasource.url=jdbc:mysql://localhost:3306/test
spring.datasource.username=root
spring.datasource.password=123456

# 日志配置
logging.level.org.springframework=info
logging.level.com.example=debug
```

```yml [YML]
# application.yml

# 服务器配置
server:
  port: 8080
  servlet:
    context-path: /api

# 数据源配置
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/test
    username: root
    password: 123456

# 日志配置
logging:
  level:
    org.springframework: info
    com.example: debug
```

:::

# 通用配置项

::: code-group

```yml [服务器配置]
server:
  port: 8080 # 服务器端口
  servlet:
    context-path: /api # 应用上下文路径
  tomcat:
    max-threads: 100 # 最大线程数
    uri-encoding: UTF-8 # URI 编码
```

```yml [数据源配置]
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/test
    username: root
    password: 123456
    driver-class-name: com.mysql.cj.jdbc.Driver
    hikari:
      maximum-pool-size: 10 # 连接池最大连接数
      minimum-idle: 5 # 连接池最小空闲连接数
      idle-timeout: 30000 # 空闲连接超时时间（毫秒）
```

```yml [日志配置]
logging:
  level:
    root: info # 根日志级别
    org.springframework: warn # Spring 框架日志级别
    com.example: debug # 应用包日志级别
  file:
    name: logs/app.log # 日志文件路径
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n" # 控制台日志格式
    file: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n" # 文件日志格式
```

```yml [应用配置]
spring:
  application:
    name: my-application # 应用名称
  profiles:
    active: dev # 激活的环境配置

# 自定义配置
my:
  app:
    version: 1.0.0
    description: This is my application
```

```yml [缓存配置]
spring:
  cache:
    type: redis # 缓存类型
  redis:
    host: localhost
    port: 6379
    password:
    database: 0
```

```yml [安全配置]
spring:
  security:
    user:
      name: admin # 默认用户名
      password: 123456 # 默认密码
      roles: ADMIN # 默认角色
```

:::

# 配置文件拆分

对于复杂的应用，可以将配置文件拆分为多个部分：

1. **按环境拆分**：

   - `application-dev.yml`：开发环境配置
   - `application-test.yml`：测试环境配置
   - `application-prod.yml`：生产环境配置

2. **按功能拆分**：
   - `application-datasource.yml`：数据源配置
   - `application-redis.yml`：Redis 配置
   - `application-security.yml`：安全配置

然后在主配置文件中引用：

```yml
spring:
  profiles:
    active: dev
    include:
      - datasource
      - redis
      - security
```

# 读取配置

在代码中读取配置的几种方式：

::: code-group

```java [@Value 注解]
import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Component;

@Component
public class AppConfig {

    @Value("${server.port}")
    private int serverPort;

    @Value("${my.app.version}")
    private String appVersion;

    // getters and setters
}
```

```java [@ConfigurationProperties 注解]
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.stereotype.Component;

@Component
@ConfigurationProperties(prefix = "my.app")
public class MyAppConfig {

    private String version;
    private String description;

    // getters and setters
}
```

```java [Environment 对象]
import org.springframework.core.env.Environment;
import org.springframework.stereotype.Component;

@Component
public class EnvConfig {

    private final Environment env;

    public EnvConfig(Environment env) {
        this.env = env;
    }

    public String getServerPort() {
        return env.getProperty("server.port");
    }
}
```

:::

# 官方配置文档

更多详细的配置选项，请参考 Spring Boot 官方配置文档：

::: tip 注意
Spring Boot [官方配置文档](https://docs.spring.io/spring-boot/appendix/application-properties/index.html)提供了详细的配置选项说明，包括默认值、类型、范围等。在使用时，建议参考官方文档以确保配置的正确性。
:::
